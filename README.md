# Курсовая работа по ИСАК
## Подготовка рабочего места и настройка виртуального окружения Python3

Необходимо установить все все интересующие нас компоненты, инсталяцию которых мы выполним с помощью инструментов apt и pip3.

### Обновим пакеты и установим nginx:
```
  sudo apt-get update
  sudo apt-get install nginx
```
Теперь необходимо установить виртуальную среду Python. Главная задача виртуальной среды – создание изолированной среды для проектов Python. Мы используем Python3, поэтому у нас уже есть модуль venv, установленный в стандартной библиотеке.

Приступим к созданию структуры приложения. В домашней директории текущего пользователя (~, /home/gold) создадим папку, в которой мы развернём виртуальную среду и будем хранить точку входа приложения WSGI. И сразу же перейдём в созданную директорию:
```
mkdir ~/cyb/
cd ~/cyb
```
Далее здесь мы создадим виртуальную среду, которая будет называться xv:
python3 -m venv xv

Таким образом, в каталоге xv развёрнуто новое виртуально окружение Python. Активируем его работу:
```
. xv/bin/activate
```
![image](https://user-images.githubusercontent.com/57058926/121810453-a6fa8380-cc69-11eb-808f-d4c321ae298b.png)

Командная строка изменилась. Это говорит о том, что виртуальная среда успешно запущена:

Когда виртуальная среда активна, все устанавливаемые приложения Python будут помещены в иерархию этого каталога.

### Установка uWSGI


Установим uWSGI сервер с помощью pip3:
```
pip3 install uwsgi
```
Создание приложения согласно спецификации WSGI


WSGI приложения имеют достаточно точную структуру.
По стандарту, они должны удовлетворять следующим требованиям:
должны быть вызываемыми (callable) объектами (обычно это функции или методы)
принимать два параметра:
словарь переменных окружения (environ)
обработчик запроса (start_response)
вызывать обработчик запроса с кодом HTTP-ответа и HTTP-заголовками
возвращать итерируемый объект с телом ответа

Создадим python-файл с названием wsgi.py в нашей директории:
```
nano ~/cyb/wsgi.py
```
Теперь поместим туда код WSGI приложения, согласно предъявляемым требованиям:

![image](https://user-images.githubusercontent.com/57058926/121810503-d4dfc800-cc69-11eb-85a6-8bcf7e792c8c.png)

По умолчанию uWSGI будет искать точку входа application, потому функция имеет соответствующее название.
Зачастую, подобного рода файлы использоваться как ссылки на остальной код приложения.

Приложение готово, деактивируем виртуальную среду:

![image](https://user-images.githubusercontent.com/57058926/121810518-e032f380-cc69-11eb-8fc9-d40ae9cd27dd.png)

Создание конфигурационного файла uWSGI


Для запуска сервера uWSGI создадим конфигурационный .ini-файл и заполним его:
![image](https://user-images.githubusercontent.com/57058926/121810537-f17c0000-cc69-11eb-99e5-adc8d36afeff.png)

Запустим сконфигурированный файл:
```
cd /home/gold/cyb
. xv/bin/activate
uwsgi --ini cyb.ini&
```
Для того, чтобы обновить состояние файлов (после внесения изменений), которые видит сервер необходимо выполнить:
```
uwsgi --ini cel.ini&
sudo nginx -s reload
```
### Настройка nginx


Далее настроим nginx как обратный прокси-сервер. nginx будет проксировать запросы при помощи протокола uwsgi для взаимодействия с uWSGI.

Создадим и заполним новый конфигурационный файл в каталоге sites-available директории nginx.
```

sudo nano /etc/nginx/sites-available/cyb
```
```
server {
listen 80;           #  порт, который будет слушать веб-сервер в ожидании запросов
server_name 127.0.0.1;    # доменное имя или ip-адрес, по которому происходит обращение к серверу
                                       # 127.0.0.1 - адрес локального хоста компьютера 

лог-файлы доступа и ошибок 
access_log    /var/log/nginx_access.log;     
error_log     /var/log/nginx_error.log;

root /home/gold/cyb;     # основная директория проекта 

все запросы перенаправляются в uwsgi-приложение

location / {
include         uwsgi_params;
uwsgi_pass      unix:/home/gold/cyb/cyb.sock; # путь к сокету, созданному .ini файлом 
   }
}
```
Далее создаём символьную ссылку на каталог sites-enabled:
```
sudo ln -s /etc/nginx/sites-available/cyb /etc/nginx/sites-enabled
```
Теперь проверим файл сервера на предмет ошибок:

![image](https://user-images.githubusercontent.com/57058926/121810818-eb3a5380-cc6a-11eb-94b0-9ee92cd78878.png)

После перезапустим nginx:
```
sudo service nginx restart
```

### Проверка работоспособности


Откроем любой браузер и в адресной строке введём и нажмём Enter:

http://127.0.0.1:8000



На экране появится веб-станица с надписью:
![image](https://user-images.githubusercontent.com/57058926/121859892-f344d280-cd00-11eb-8a89-cb276af8ab68.png)

Hello world!
Так же можно проверить логи ошибок.
![Uploading image.png…]()
Никаких новых ошибок не выдает.(файл заполнен прошлыми попытками)
